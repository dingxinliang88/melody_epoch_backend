<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.github.dingxinliang88.mapper.SongMapper">

    <resultMap id="SongMapper" type="io.github.dingxinliang88.pojo.po.Song">
        <id column="song_id" property="songId"/>
        <result column="name" property="name"/>
        <result column="band_id" property="bandId"/>
        <result column="author" property="author"/>
        <result column="album_id" property="albumId"/>
        <result column="album_name" property="albumName"/>
        <result column="is_release" property="isRelease"/>
        <result column="is_delete" property="isDelete"/>
    </resultMap>
    <update id="editInfo" parameterType="io.github.dingxinliang88.pojo.dto.song.EditSongReq">
        UPDATE song SET album_id = #{albumId}, album_name = #{albumName}
        WHERE song_id = #{songId} AND band_id = #{bandId} AND is_delete = 0;
    </update>
    <select id="queryBySongIdAndBandIdInner" resultType="io.github.dingxinliang88.pojo.po.Song">
        SELECT song_id, name, band_id, author, album_id, album_name, is_release, is_delete
        FROM song
        WHERE song_id = #{songId} AND band_id = #{bandId} AND is_delete = 0;
    </select>
    <select id="querySongsByBandId" resultType="io.github.dingxinliang88.pojo.po.Song">
        SELECT song_id, name, band_id, author, album_id, album_name
        FROM song
        WHERE band_id = #{bandId} AND is_delete = 0 AND is_release = 1;
    </select>
    <select id="listSongItemsByBandId" resultType="io.github.dingxinliang88.pojo.vo.song.SongItemVO">
        SELECT song_id, name
        FROM song
        WHERE band_id = #{bandId} AND is_delete = 0;
    </select>
    <select id="listSongs" resultType="io.github.dingxinliang88.pojo.po.Song">
        SELECT song_id, name, band_id, author, album_id, album_name, is_release
        FROM song
        WHERE is_release = 1 AND is_delete = 0;
    </select>
    <select id="listSongInfoVO" resultType="io.github.dingxinliang88.pojo.vo.song.SongInfoVO">
        SELECT song_id, song.name AS name, band.name AS band_name, author, album_name
        FROM song
        LEFT JOIN band
        ON song.band_id = band.band_id
        WHERE song.is_release = 1 AND song.is_delete = 0;
    </select>


</mapper>
